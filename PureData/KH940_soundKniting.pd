#N canvas 404 22 704 670 10;
#X msg -160 -402 close;
#X msg -147 -380 devices;
#X obj -134 -358 r OUT;
#X msg -179 -424 open 2;
#N canvas 0 22 450 300 (subpatch) 0;
#X array knit 200 float 0;
#X coords 0 1 199 0 200 150 1 0 0;
#X restore 210 -424 graph;
#X obj 96 -71 until;
#X obj 96 -37 f;
#X obj 124 -37 + 1;
#X msg 159 -71 0;
#X msg 96 -118 200;
#X obj 96 -95 trigger f b;
#N canvas 853 22 293 604 fft 0;
#X obj 150 72 rfft~;
#X obj 150 99 *~;
#X obj 177 99 *~;
#X obj 150 34 inlet~;
#X obj 150 128 sqrt~;
#X obj 213 35 block~ 4095;
#X obj 35 118 metro 100;
#X obj 35 249 until;
#X obj 35 287 f;
#X obj 63 287 + 1;
#X msg 98 249 0;
#X msg 35 199 200;
#X obj 35 222 trigger f b;
#X obj 35 452 sel 1;
#X obj 35 362 i;
#X obj 35 313 trigger f f;
#X obj 35 387 t f f;
#X obj 35 479 pack f f f;
#X obj 35 426 >= 40;
#X msg 69 553 \; knit \$1 1;
#X obj 69 527 change;
#X obj 35 502 unpack f f f;
#X obj 149 365 r seuil;
#X msg 48 72 \; pd dsp \$1;
#X obj 35 34 inlet;
#X obj 150 182 tabwrite~ spectrum;
#X obj 35 338 tabread spectrum;
#X obj 35 144 trigger bang bang;
#X connect 0 0 1 0;
#X connect 0 0 1 1;
#X connect 0 1 2 0;
#X connect 0 1 2 1;
#X connect 1 0 4 0;
#X connect 2 0 4 0;
#X connect 3 0 0 0;
#X connect 4 0 25 0;
#X connect 6 0 27 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 8 0 15 0;
#X connect 9 0 8 1;
#X connect 10 0 8 1;
#X connect 11 0 12 0;
#X connect 12 0 7 0;
#X connect 12 1 10 0;
#X connect 13 0 17 0;
#X connect 14 0 16 0;
#X connect 15 0 26 0;
#X connect 15 1 17 1;
#X connect 16 0 18 0;
#X connect 16 1 17 2;
#X connect 17 0 21 0;
#X connect 18 0 13 0;
#X connect 20 0 19 0;
#X connect 21 1 20 0;
#X connect 22 0 18 1;
#X connect 24 0 23 0;
#X connect 24 0 6 0;
#X connect 26 0 14 0;
#X connect 27 0 11 0;
#X connect 27 1 25 0;
#X restore -179 82 pd fft;
#N canvas 73 177 1153 478 (subpatch) 0;
#X array spectrum 200 float 3;
#A 0 0.0408936 0.0457994 0.158808 0.271853 0.43643 0.0881644 0.111467
0.128621 0.0428371 0.171379 0.0856411 0.0542435 0.0664209 0.0226019
0.010396 0.0248841 0.013321 0.0323518 0.0283777 0.0295826 0.0106784
0.00437494 0.0169965 0.0128008 0.0120307 0.00667264 0.0118084 0.00159465
0.0114055 0.0108412 0.0127656 0.00601633 0.0264572 0.0124824 0.00726952
0.0113704 0.0166541 0.0167187 0.00662386 0.00528192 0.014348 0.0123534
0.0034483 0.0119376 0.00665459 0.0147242 0.00769294 0.00768578 0.00643251
0.0138336 0.00382698 0.0253689 0.0126086 0.0171427 0.00994042 0.00522649
0.00675037 0.00646046 0.0176221 0.00584183 0.00470857 0.00903319 0.0123303
0.00662022 0.00421896 0.0181219 0.0129342 0.00136666 0.0105535 0.00382844
0.00456126 0.00783729 0.00949034 0.00930241 0.00351815 0.00761498 0.00308581
0.00619816 0.00396652 0.00498666 0.00794954 0.00423158 0.00659818 0.0112817
0.00886358 0.00694698 0.00976093 0.00906868 0.00991637 0.00481701 0.00527746
0.00154046 0.00999297 0.00291299 0.00176163 0.00273706 0.00657744 0.00175438
0.00712943 0.00615195 0.0110555 0.0116105 0.00200817 0.00579549 0.00641331
0.0152907 0.00925007 0.00160205 0.00408184 0.00430726 0.00387994 0.00327033
0.00331632 0.00340464 0.00241611 0.00317447 0.00628875 0.00566481 0.00769928
0.00745799 0.00608097 0.0127383 0.00447251 0.00315628 0.00495985 0.0169001
0.0042478 0.00302281 0.00389797 0.00403244 0.00859616 0.0114278 0.00799981
0.00510782 0.00110052 0.00817893 0.00667878 0.00282852 0.00144292 0.00468555
0.00274557 0.00327546 0.00708973 0.00345177 0.00658207 0.00752041 0.00621229
0.0028021 0.0039368 0.00300381 0.0031764 0.0109806 0.0034908 0.000245821
0.00100967 0.000960332 0.00508277 0.00820012 0.00380063 0.00958259
0.00565002 0.00658987 0.00512907 0.00542717 0.00505932 0.00484772 0.00474296
0.00850584 0.00338207 0.00300617 0.00532237 0.00756095 0.00527094 0.00584684
0.00761932 0.00425223 0.00341946 0.010374 0.00713157 0.00702814 0.00736206
0.00829886 0.0037976 0.00219125 0.00334743 0.00470453 0.00237624 0.00212468
0.00497374 0.00903244 0.00538534 0.00358647 0.00158128 0.00415611 0.00145097
0.00576074 0.00385048 0.00356409 0.00409022 0.00200046;
#X coords 0 100 200 0 200 150 1 0 0;
#X restore -15 -424 graph;
#X obj 190 -263 s seuil;
#X obj 246 5 tabread knit;
#X obj 246 29 list prepend;
#X obj 225 61 list;
#X obj 96 -141 trigger bang bang bang;
#X obj 261 61 trigger list;
#X obj 96 -12 trigger float float;
#X obj 225 144 s OUT;
#X obj -179 -281 sel 64;
#X obj -179 -304 comport 2 38400;
#X obj 266 144 s OUT;
#N canvas 578 287 109 204 bip 0;
#X obj 28 28 inlet;
#X obj 28 147 osc~;
#X obj 28 177 dac~;
#X obj 28 51 t b b;
#X msg 28 109 0;
#X msg 60 110 800;
#X obj 28 79 delay 100;
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 1 0 2 1;
#X connect 3 0 6 0;
#X connect 3 1 5 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X connect 6 0 4 0;
#X restore -80 -234 pd bip;
#X obj -87 37 readsf~;
#X msg -87 -128 bang;
#X obj -87 -59 openpanel;
#X obj 96 -164 metro 500;
#X obj -87 85 dac~;
#X obj 96 -187 r START_STOP;
#X obj -49 -83 s START_STOP;
#X msg -49 -128 1;
#X obj -48 84 s START_STOP;
#X msg -48 60 0;
#N canvas 219 22 996 723 fiddle 0;
#X obj 272 532 phasor~;
#X obj 541 626 unpack;
#X floatatom 541 676 0 0 0 0 - - -;
#X msg 447 459 print;
#X obj 272 510 sig~;
#X floatatom 272 488 0 0 0 0 - - -;
#X obj 272 466 mtof;
#X floatatom 272 444 0 0 0 0 - - -;
#X floatatom 555 653 0 0 0 0 - - -;
#X obj 541 586 route 1 2 3 4;
#X obj 624 626 unpack;
#X floatatom 624 676 0 0 0 0 - - -;
#X floatatom 638 653 0 0 0 0 - - -;
#X obj 708 626 unpack;
#X floatatom 708 676 0 0 0 0 - - -;
#X floatatom 722 653 0 0 0 0 - - -;
#X obj 399 626 unpack;
#X floatatom 399 676 0 0 0 0 - - -;
#X floatatom 413 653 0 0 0 0 - - -;
#X obj 344 555 *~;
#X obj 332 404 loadbang;
#X obj 363 532 sig~;
#X floatatom 363 510 0 0 0 0 - - -;
#X msg 332 488 1;
#X msg 363 488 0;
#X floatatom 476 676 0 0 0 0 - - -;
#X obj 291 676 print attack;
#X obj 200 676 print pitch;
#X msg 565 55 \; pd dsp 1;
#X text 470 49 click here;
#X text 470 71 to start DSP;
#X text 236 14 FIDDLE - pitch estimator and sinusoidal peak finder
;
#X text 18 80 The Fiddle object estimates the pitch and amplitude of
an incoming sound \, both continuously and as a stream of discrete
"note" events. Fiddle optionally outputs a list of detected sinusoidal
peaks used to make the pitch determination. Fiddle is described theoretically
in the 1998 ICMC proceedings \, reprinted on http://man104nfs.ucsd.edu/~mpuckett.
;
#X text 18 180 Fiddle's creation arguments specify an analysis window
size \, the maximum polyphony (i.e. \, the number of simultaneous "pitches"
to try to find) \, the number of peaks in the spectrum to consider
\, and the number of peaks \, if any \, to output "raw." The outlets
give discrete pitch (a number) \, detected attacks in the amplitude
envelope (a bang) \, one or more voices of continuous pitch and amplitude
\, overall amplitude \, and optionally a sequence of messages with
the peaks.;
#X text 18 306 The analysis hop size is half the window size so in
the example shown here \, one analysis is done every 512 samples (11.6
msec at 44K1) \, and the analysis uses the most recent 1024 samples
(23.2 msec at 44K1). The minimum frequency that Fiddle will report
is 2-1/2 cycles per analysis windows \, or about 108 Hz. (just below
MIDI 45.);
#X text 679 545 number of pitch outlets (1-3 \, default 1);
#X text 679 567 number of peaks to find (1-100 \, default 20);
#X text 679 589 number of peaks to output (default 0.);
#X msg 451 117 amp-range 40 50;
#X msg 449 237 reattack 100 10;
#X msg 448 292 npartial 7;
#X msg 448 180 vibrato 50 0.5;
#X text 570 101 a low and high amplitude threshold: if signal amplitude
is below the low threshold \, no pitches or peaks are output. The high
threshold is a minimum at which "cooked" outputs may appear.;
#X text 570 162 A period in milliseconds (50) over which the raw pitch
may not deviate more than an interval in half-tones (0.5) from the
average pitch to report it as a note to the "cooked" pitch outlet.
;
#X text 570 223 A period in milliseconds (100) over which a re-attack
is reported if the amplitude rises more than (1) dB. The re-attack
will result in a "bang" in the attack outlet and may give rise to repeated
notes in the cooked pitch output.;
#X text 152 442 test input pitch;
#X text 340 454 test input;
#X text 340 467 amplitude;
#X obj 420 555 fiddle~ 1024 1 20 3;
#X text 548 700 individual sinusoidal components;
#X text 476 698 amplitude;
#X text 486 713 (dB);
#X text 399 698 raw pitch;
#X text 386 722 and amplitude;
#X text 374 739 (up to 3 outputs);
#X text 297 696 bang on;
#X text 297 718 attack;
#X text 195 696 cooked pitch;
#X text 212 713 output;
#X text 555 555 ------ arguments:;
#X msg 272 422 57;
#X msg 450 341 auto 1;
#X msg 450 363 auto 0;
#X msg 449 428 bang;
#X text 571 426 poll current values --- useful if not in auto mode
\,;
#X text 570 284 Higher partials are weighed less strongly than lower
ones in determining the pitch. This specifies the number of the partial
(7) which will be weighted half as strongly as the fundamental.;
#X text 570 345 start and stop "auto" mode (on by default.) If off
\, output only appears on "bang" (poll mode).;
#X text 571 458 print out all settings;
#X text 679 523 window size (128-2048 \, default 1024);
#X msg 450 385 npoints 2048;
#X text 572 394 number of points in analysis window (power of 2 \,
128-2048);
#X msg 449 406 npoints 1024;
#X obj 233 56 inlet~;
#X connect 0 0 19 0;
#X connect 1 0 2 0;
#X connect 1 1 8 0;
#X connect 3 0 48 0;
#X connect 4 0 0 0;
#X connect 5 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 6 0;
#X connect 9 0 1 0;
#X connect 9 1 10 0;
#X connect 9 2 13 0;
#X connect 10 0 11 0;
#X connect 10 1 12 0;
#X connect 13 0 14 0;
#X connect 13 1 15 0;
#X connect 16 0 17 0;
#X connect 16 1 18 0;
#X connect 19 0 48 0;
#X connect 20 0 60 0;
#X connect 20 0 23 0;
#X connect 21 0 19 1;
#X connect 22 0 21 0;
#X connect 23 0 22 0;
#X connect 24 0 22 0;
#X connect 38 0 48 0;
#X connect 39 0 48 0;
#X connect 40 0 48 0;
#X connect 41 0 48 0;
#X connect 48 0 27 0;
#X connect 48 1 26 0;
#X connect 48 2 16 0;
#X connect 48 3 25 0;
#X connect 48 4 9 0;
#X connect 60 0 7 0;
#X connect 61 0 48 0;
#X connect 62 0 48 0;
#X connect 63 0 48 0;
#X connect 69 0 48 0;
#X connect 71 0 48 0;
#X connect 72 0 48 0;
#X restore -179 105 pd fiddle;
#X obj 190 -422 vsl 15 149 0 127 0 0 empty empty empty 0 -9 0 10 -257985
-1 -1 5700 1;
#X msg 96 121 \; knit \$1 \$2;
#X obj 96 88 pack f f;
#X obj 96 33 t f b;
#X obj 141 61 f;
#X obj 169 61 + 1;
#X obj 199 61 % 2;
#X obj -179 -39 r START_STOP;
#X obj -179 -258 trigger bang bang;
#X obj -179 -180 s knitting;
#X obj 329 86 r START_STOP;
#X msg -87 -37 open \$1;
#N canvas 401 27 576 479 req_play 0;
#X obj 137 351 qlist;
#X msg 255 166 rewind;
#X msg 354 256 next;
#X text 304 164 go to beginning (and stop);
#X text 390 255 single-step forward;
#X text 456 133 read a file;
#X text 381 106 write one;
#X msg 137 166 clear;
#X msg 236 106 write ./pattern_00.txt;
#X msg 319 135 read ./pattern_00.txt;
#X obj 25 -14 inlet;
#X obj 25 64 list append 1 2;
#X msg 25 40 add;
#X obj 25 14 t b a;
#X obj 25 87 list trim;
#X obj 137 412 outlet;
#X obj 137 -14 inlet;
#X obj 354 221 r knitting;
#X msg 260 399 \; knit \$1;
#X obj 184 412 print LIST;
#X obj 137 376 t a a;
#X obj 137 14 sel 1 0;
#X obj 137 63 trigger bang bang;
#X obj 255 63 trigger bang bang bang;
#X msg 384 86 write ./pattern_00.txt;
#X obj 25 166 print LIST;
#X connect 0 0 20 0;
#X connect 1 0 0 0;
#X connect 2 0 0 0;
#X connect 7 0 0 0;
#X connect 8 0 0 0;
#X connect 9 0 0 0;
#X connect 10 0 13 0;
#X connect 11 0 14 0;
#X connect 12 0 11 0;
#X connect 13 0 12 0;
#X connect 13 1 11 1;
#X connect 14 0 0 0;
#X connect 14 0 25 0;
#X connect 16 0 21 0;
#X connect 17 0 2 0;
#X connect 20 0 15 0;
#X connect 20 1 19 0;
#X connect 21 0 22 0;
#X connect 21 1 23 0;
#X connect 22 0 7 0;
#X connect 22 1 8 0;
#X connect 23 0 1 0;
#X connect 23 1 9 0;
#X connect 23 2 24 0;
#X connect 24 0 0 0;
#X restore 266 112 pd req_play;
#X obj -206 -281 bng 15 250 50 0 empty empty empty 17 7 0 10 -258113
-1 -1;
#N canvas 578 287 109 204 bip 0;
#X obj 28 17 inlet;
#X obj 28 136 osc~;
#X obj 28 166 dac~;
#X obj 28 40 t b b;
#X msg 28 98 0;
#X obj 28 68 delay 100;
#X msg 60 99 400;
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 1 0 2 1;
#X connect 3 0 5 0;
#X connect 3 1 6 0;
#X connect 4 0 1 0;
#X connect 5 0 4 0;
#X connect 6 0 1 0;
#X restore -160 -204 pd bip;
#X obj -179 -234 delay 1200;
#X connect 0 0 22 0;
#X connect 1 0 22 0;
#X connect 3 0 22 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 6 0 19 0;
#X connect 7 0 6 1;
#X connect 8 0 6 1;
#X connect 9 0 10 0;
#X connect 10 0 5 0;
#X connect 10 1 8 0;
#X connect 14 0 15 0;
#X connect 15 0 16 1;
#X connect 15 0 18 0;
#X connect 16 0 20 0;
#X connect 16 0 48 0;
#X connect 17 0 9 0;
#X connect 17 1 15 1;
#X connect 17 2 16 0;
#X connect 18 0 15 1;
#X connect 19 0 39 0;
#X connect 19 1 14 0;
#X connect 21 0 44 0;
#X connect 22 0 21 0;
#X connect 25 0 11 1;
#X connect 25 0 29 0;
#X connect 25 0 29 1;
#X connect 25 1 34 0;
#X connect 26 0 27 0;
#X connect 27 0 47 0;
#X connect 28 0 17 0;
#X connect 30 0 28 0;
#X connect 32 0 31 0;
#X connect 34 0 33 0;
#X connect 36 0 13 0;
#X connect 38 0 37 0;
#X connect 39 0 38 0;
#X connect 39 1 40 0;
#X connect 40 0 41 0;
#X connect 40 0 38 1;
#X connect 41 0 42 0;
#X connect 42 0 40 1;
#X connect 43 0 11 0;
#X connect 43 0 25 0;
#X connect 44 0 51 0;
#X connect 44 1 24 0;
#X connect 46 0 48 1;
#X connect 47 0 25 0;
#X connect 48 0 23 0;
#X connect 49 0 44 0;
#X connect 51 0 45 0;
#X connect 51 0 50 0;
